<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Disposition Assessment</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .form-section {
            padding: 40px;
        }
        
        .name-input {
            margin-bottom: 40px;
        }
        
        .name-input label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 1.1em;
        }
        
        .name-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }
        
        .name-input input:focus {
            outline: none;
            border-color: #4facfe;
        }
        
        .question {
            margin-bottom: 35px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #4facfe;
        }
        
        .question h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2em;
            line-height: 1.5;
        }
        
        .rating-scale {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            justify-content: space-between;
        }
        
        .rating-option {
            flex: 1;
            min-width: 160px;
            text-align: center;
            position: relative;
        }
        
        .rating-option input {
            display: none;
        }
        
        .rating-option label {
            display: block;
            padding: 15px 8px;
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9em;
            text-align: center;
            line-height: 1.3;
        }
        
        .rating-option input:checked + label {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-color: #4facfe;
            color: white;
            transform: translateY(-2px);
        }
        
        .rating-option label:hover {
            border-color: #4facfe;
            transform: translateY(-1px);
        }
        
        .submit-section {
            text-align: center;
            padding: 40px;
            background: #f8f9fa;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s ease;
            font-weight: 600;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .results {
            display: none;
            padding: 40px;
            text-align: center;
        }
        
        .results h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2em;
        }
        
        .score-display {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
            justify-content: center;
        }
        
        .score-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            flex: 1;
            min-width: 250px;
        }
        
        .score-card h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        
        .score-value {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .score-detail {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.3s ease;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .instructor-panel {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #4facfe;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 400px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .form-section {
                padding: 30px 20px;
            }
            
            .rating-scale {
                flex-direction: column;
                gap: 8px;
            }
            
            .rating-option {
                min-width: 100%;
            }
            
            .score-display {
                flex-direction: column;
                gap: 20px;
            }
            
            .score-card {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Student Disposition Assessment</h1>
            <p>Evaluate your learning attitudes and perspectives</p>
        </div>
        
        <div id="survey-form">
            <div class="form-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <div class="name-input">
                    <label for="student-name">Your Full Name *</label>
                    <input type="text" id="student-name" required placeholder="Enter your full name">
                </div>
                
                <form id="disposition-survey">
                    <!-- Questions will be generated here -->
                </form>
                
                <div class="submit-section">
                    <button type="submit" class="submit-btn" id="submit-btn">Complete Assessment</button>
                </div>
            </div>
        </div>
        
        <div id="results" class="results">
            <h2>Assessment Complete!</h2>
            <div class="score-display">
                <div class="score-card">
                    <h3>Your Score</h3>
                    <div class="score-value" id="individual-score">0</div>
                    <div class="score-detail" id="individual-percentage">0% Positive Disposition</div>
                </div>
                <div class="score-card">
                    <h3>Class Average</h3>
                    <div class="score-value" id="class-score">0</div>
                    <div class="score-detail" id="class-percentage">0% Positive Disposition</div>
                </div>
            </div>
            <button class="download-btn" onclick="generatePDF()">Download PDF Report</button>
            <button class="download-btn" onclick="resetSurvey()">Take Again</button>
        </div>
    </div>

    <!-- Instructor Panel -->
    <div id="instructor-panel" class="instructor-panel">
        <h3 style="color: #333; margin-bottom: 15px;">ðŸ“Š Instructor Panel</h3>
        <div id="instructor-stats"></div>
        <button onclick="exportClassData()" style="margin: 10px 5px; padding: 8px 15px; background: #4facfe; color: white; border: none; border-radius: 5px; cursor: pointer;">Export CSV</button>
        <button onclick="clearClassData()" style="margin: 10px 5px; padding: 8px 15px; background: #f5576c; color: white; border: none; border-radius: 5px; cursor: pointer;">Clear Data</button>
        <button onclick="toggleInstructorPanel()" style="margin: 10px 5px; padding: 8px 15px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer;">Close</button>
    </div>

    <script>
        // Survey questions
        const questions = [
            "I believe that all students can learn and succeed with appropriate support and instruction.",
            "I am committed to creating an inclusive classroom environment that welcomes diversity.",
            "I view challenges in teaching as opportunities for professional growth and learning.",
            "I actively seek feedback from colleagues, mentors, and students to improve my practice.",
            "I am passionate about my subject area and enjoy sharing that enthusiasm with students.",
            "I believe in maintaining high expectations while providing necessary scaffolding for all learners.",
            "I am willing to adapt my teaching methods to meet the diverse needs of my students.",
            "I recognize the importance of building positive relationships with students and their families.",
            "I am committed to ongoing professional development throughout my teaching career.",
            "I believe that effective classroom management stems from mutual respect and clear expectations.",
            "I value collaboration with colleagues and see teaching as a team effort.",
            "I am prepared to advocate for my students' needs within the school and broader community.",
            "I understand that cultural responsiveness is essential for effective teaching.",
            "I am committed to using data and evidence to inform my instructional decisions.",
            "I believe that every student deserves equitable access to quality education.",
            "I am resilient and can maintain a positive attitude despite challenges in education.",
            "I see parents and caregivers as important partners in the educational process.",
            "I am committed to fostering critical thinking and problem-solving skills in my students.",
            "I believe in the importance of social-emotional learning alongside academic achievement.",
            "I am prepared to be a lifelong learner and reflective practitioner in education."
        ];

        // Global variables
        let responses = [];
        let classData = JSON.parse(localStorage.getItem('classResponses')) || [];

        // Initialize survey
        function createSurvey() {
            const form = document.getElementById('disposition-survey');
            
            questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                // Create question title
                const title = document.createElement('h3');
                title.textContent = `${index + 1}. ${question}`;
                questionDiv.appendChild(title);
                
                // Create rating scale
                const ratingScale = document.createElement('div');
                ratingScale.className = 'rating-scale';
                
                // Rating options with full text
                const ratingOptions = [
                    { value: 1, text: '1 - Strongly Disagree' },
                    { value: 2, text: '2 - Disagree' },
                    { value: 3, text: '3 - Neutral' },
                    { value: 4, text: '4 - Agree' },
                    { value: 5, text: '5 - Strongly Agree' }
                ];
                
                ratingOptions.forEach(option => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'rating-option';
                    
                    const input = document.createElement('input');
                    input.type = 'radio';
                    input.id = `q${index}_${option.value}`;
                    input.name = `question_${index}`;
                    input.value = option.value;
                    input.required = true;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `q${index}_${option.value}`;
                    label.textContent = option.text;
                    
                    optionDiv.appendChild(input);
                    optionDiv.appendChild(label);
                    ratingScale.appendChild(optionDiv);
                });
                
                questionDiv.appendChild(ratingScale);
                form.appendChild(questionDiv);
            });
        }

        // Update progress bar
        function updateProgress() {
            const totalQuestions = questions.length;
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const nameInput = document.getElementById('student-name');
            
            const progress = (answeredQuestions / totalQuestions) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            const submitBtn = document.getElementById('submit-btn');
            const canSubmit = answeredQuestions === totalQuestions && nameInput.value.trim().length > 0;
            
            submitBtn.disabled = !canSubmit;
            submitBtn.style.opacity = canSubmit ? '1' : '0.6';
        }

        // Handle form submission
        function handleSubmission(e) {
            e.preventDefault();
            
            const name = document.getElementById('student-name').value.trim();
            if (!name) {
                alert('Please enter your name.');
                return;
            }
            
            // Collect responses
            responses = [];
            let totalScore = 0;
            
            for (let i = 0; i < questions.length; i++) {
                const checkedInput = document.querySelector(`input[name="question_${i}"]:checked`);
                if (!checkedInput) {
                    alert(`Please answer question ${i + 1}.`);
                    return;
                }
                
                const score = parseInt(checkedInput.value);
                responses.push({
                    question: questions[i],
                    score: score
                });
                totalScore += score;
            }
            
            // Store data
            const studentData = {
                name: name,
                responses: responses,
                totalScore: totalScore,
                date: new Date().toISOString()
            };
            
            classData.push(studentData);
            localStorage.setItem('classResponses', JSON.stringify(classData));
            
            // Show results
            showResults(studentData);
            updateInstructorStats();
        }

        // Show results
        function showResults(studentData) {
            const maxScore = questions.length * 5;
            const studentPercentage = Math.round((studentData.totalScore / maxScore) * 100);
            
            // Calculate class average
            const classAverage = classData.reduce((sum, student) => sum + student.totalScore, 0) / classData.length;
            const classPercentage = Math.round((classAverage / maxScore) * 100);
            
            // Update display
            document.getElementById('individual-score').textContent = studentData.totalScore;
            document.getElementById('individual-percentage').textContent = studentPercentage + '% Positive Disposition';
            document.getElementById('class-score').textContent = Math.round(classAverage);
            document.getElementById('class-percentage').textContent = classPercentage + '% Positive Disposition';
            
            // Store for PDF generation
            window.currentResults = {
                individual: studentData,
                class: { average: classAverage, percentage: classPercentage, count: classData.length }
            };
            
            // Switch views
            document.getElementById('survey-form').style.display = 'none';
            document.getElementById('results').style.display = 'block';
        }

        // Generate PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const results = window.currentResults;
            const maxScore = questions.length * 5;
            
            // Header
            doc.setFillColor(79, 172, 254);
            doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.text('Student Disposition Assessment Report', 105, 25, { align: 'center' });
            
            // Reset text color
            doc.setTextColor(0, 0, 0);
            
            // Student info
            doc.setFontSize(16);
            doc.text('Student: ' + results.individual.name, 20, 60);
            doc.text('Date: ' + new Date().toLocaleDateString(), 20, 75);
            doc.text('Total Class Responses: ' + classData.length, 20, 90);
            
            // Scores
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('ASSESSMENT RESULTS', 20, 115);
            doc.setFont(undefined, 'normal');
            
            const individualPercentage = Math.round((results.individual.totalScore / maxScore) * 100);
            doc.text(`Your Score: ${results.individual.totalScore}/${maxScore} (${individualPercentage}%)`, 20, 135);
            doc.text(`Class Average: ${Math.round(results.class.average)}/${maxScore} (${results.class.percentage}%)`, 20, 150);
            
            // Interpretation
            doc.setFont(undefined, 'bold');
            doc.text('INTERPRETATION', 20, 175);
            doc.setFont(undefined, 'normal');
            
            let interpretation = '';
            if (individualPercentage >= 90) {
                interpretation = 'Exceptional: You demonstrate outstanding positive disposition toward teaching and learning.';
            } else if (individualPercentage >= 80) {
                interpretation = 'Strong: You show very positive attitudes and readiness for educational challenges.';
            } else if (individualPercentage >= 70) {
                interpretation = 'Good: You display generally positive disposition with room for growth.';
            } else if (individualPercentage >= 60) {
                interpretation = 'Developing: Consider reflecting on areas where you can strengthen your educational mindset.';
            } else {
                interpretation = 'Needs Attention: Significant reflection and development of educational disposition recommended.';
            }
            
            const splitText = doc.splitTextToSize(interpretation, 170);
            doc.text(splitText, 20, 190);
            
            doc.save(`${results.individual.name.replace(/\s+/g, '_')}_Disposition_Assessment.pdf`);
        }

        // Reset survey
        function resetSurvey() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('survey-form').style.display = 'block';
            document.getElementById('disposition-survey').reset();
            document.getElementById('student-name').value = '';
            document.getElementById('progress-fill').style.width = '0%';
            updateProgress();
        }

        // Instructor functions
        function updateInstructorStats() {
            const statsDiv = document.getElementById('instructor-stats');
            const totalResponses = classData.length;
            
            if (totalResponses === 0) {
                statsDiv.innerHTML = '<p>No responses yet.</p>';
                console.log('=== CLASS STATISTICS ===');
                console.log('Total Responses: 0');
                console.log('No data available yet.');
                return;
            }
            
            const maxScore = questions.length * 5;
            const avgScore = classData.reduce((sum, student) => sum + student.totalScore, 0) / totalResponses;
            const avgPercentage = Math.round((avgScore / maxScore) * 100);
            
            statsDiv.innerHTML = `
                <p><strong>Total Responses:</strong> ${totalResponses}</p>
                <p><strong>Class Average:</strong> ${avgScore.toFixed(1)}/${maxScore} (${avgPercentage}%)</p>
                <div style="max-height: 200px; overflow-y: auto; margin-top: 10px;">
                    <table style="width: 100%; font-size: 0.9em;">
                        <thead>
                            <tr style="background: #f0f0f0;">
                                <th style="padding: 5px; text-align: left;">Name</th>
                                <th style="padding: 5px; text-align: center;">Score</th>
                                <th style="padding: 5px; text-align: center;">%</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${classData.map(student => {
                                const percentage = Math.round((student.totalScore / maxScore) * 100);
                                return `
                                    <tr>
                                        <td style="padding: 5px;">${student.name}</td>
                                        <td style="padding: 5px; text-align: center;">${student.totalScore}</td>
                                        <td style="padding: 5px; text-align: center;">${percentage}%</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            // Console output
            console.log('=== CLASS STATISTICS ===');
            console.log(`Total Responses: ${totalResponses}`);
            console.log(`Average Score: ${avgScore.toFixed(1)}/${maxScore} (${avgPercentage}%)`);
            console.log('Individual Responses:');
            classData.forEach((student, index) => {
                const percentage = Math.round((student.totalScore / maxScore) * 100);
                console.log(`${index + 1}. ${student.name}: ${student.totalScore} (${percentage}%) - ${new Date(student.date).toLocaleDateString()}`);
            });
        }

        function toggleInstructorPanel() {
            const panel = document.getElementById('instructor-panel');
            if (panel.style.display === 'none' || panel.style.display === '') {
                panel.style.display = 'block';
                updateInstructorStats();
            } else {
                panel.style.display = 'none';
            }
        }

        function exportClassData() {
            if (classData.length === 0) {
                alert('No data to export yet.');
                return;
            }
            
            let csv = 'Name,Score,Percentage,Date,Individual Responses\n';
            
            classData.forEach(student => {
                const maxScore = questions.length * 5;
                const percentage = Math.round((student.totalScore / maxScore) * 100);
                const responseString = student.responses.map(r => r.score).join('|');
                csv += `"${student.name}",${student.totalScore},${percentage}%,"${new Date(student.date).toLocaleDateString()}","${responseString}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `class_disposition_data_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function clearClassData() {
            if (confirm('Are you sure you want to clear all class data? This action cannot be undone.')) {
                localStorage.removeItem('classResponses');
                classData = [];
                updateInstructorStats();
                alert('Class data cleared successfully.');
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            createSurvey();
            updateProgress();
            updateInstructorStats();
            
            // Form submission
            document.getElementById('disposition-survey').addEventListener('submit', handleSubmission);
            document.getElementById('submit-btn').addEventListener('click', handleSubmission);
            
            // Progress tracking
            document.addEventListener('change', function(e) {
                if (e.target.type === 'radio') {
                    updateProgress();
                }
            });
            
            document.getElementById('student-name').addEventListener('input', updateProgress);
            
            // Keyboard shortcut for instructor panel
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                    e.preventDefault();
                    toggleInstructorPanel();
                }
            });
        });
    </script>
</body>
</html>
